<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>ì„ìš© í•©ê²© ë„ìš°ë¯¸</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>
:root{
  --bg:#FFF8EE;
  --main:#6B4F3F;
  --sub:#C89F6A;
  --accent:#FFB703;
}

*{box-sizing:border-box;}
body{
  margin:0;
  font-family:'Pretendard','Apple SD Gothic Neo',sans-serif;
  background:var(--bg);
}

/* ---------- ê³µí†µ ---------- */
.hidden{ display:none; }
.center{
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
  flex-direction:column;
}

/* ---------- ì‹œì‘ í™”ë©´ ---------- */
#startScreen{
  background:url("background.png") center/contain no-repeat;
  background-color:#111;
  text-align:center;
  color:#fff;
}

#startScreen h1{
  font-size:42px;
  margin-bottom:30px;
  text-shadow:0 3px 6px rgba(0,0,0,.5);
}

.start-btn{
  padding:16px 36px;
  font-size:20px;
  border:none;
  border-radius:999px;
  background:var(--accent);
  color:#333;
  cursor:pointer;
  box-shadow:0 6px 0 #e39b00;
  transition:.2s;
}

.start-btn:hover{
  transform:translateY(-2px);
  box-shadow:0 8px 0 #e39b00;
}

/* ---------- ë©”ì¸ í™”ë©´ ---------- */
header{
  background:#fff;
  padding:16px;
  text-align:center;
  font-size:24px;
  font-weight:700;
  color:var(--main);
  border-bottom:3px solid var(--sub);
}

main{
  max-width:720px;
  margin:30px auto;
  padding:20px;
}

.card{
  background:#fff;
  border-radius:20px;
  padding:20px;
  margin-bottom:20px;
  box-shadow:0 6px 0 #e0d4c2;
}

select, input[type=file]{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:2px solid var(--sub);
  font-size:16px;
}

button{
  margin-top:10px;
  width:100%;
  padding:14px;
  border:none;
  border-radius:999px;
  background:var(--sub);
  color:#fff;
  font-size:18px;
  cursor:pointer;
}

button:hover{
  background:var(--accent);
  color:#333;
}

.choice{
  margin:8px 0;
}
</style>
</head>

<body>

<!-- ================= ì‹œì‘ í™”ë©´ ================= -->
<section id="startScreen" class="center">
  <h1>ì„ìš© í•©ê²© ë„ìš°ë¯¸</h1>
  <button class="start-btn" onclick="startApp()">ê³µë¶€í•˜ê¸°</button>
</section>

<!-- ================= ë©”ì¸ í™”ë©´ ================= -->
<section id="mainScreen" class="hidden">
  <header>ğŸ¼ ì„ìš© í•©ê²© ë„ìš°ë¯¸</header>

  <main>
    <div class="card">
      <h3>ğŸ“‚ CSV ì—…ë¡œë“œ</h3>
      <input type="file" id="csvFile" accept=".csv">
    </div>

    <div class="card">
      <h3>ğŸ“š ë¬¸ì œ ì„ íƒ</h3>
      <select id="subjectSelect"></select><br><br>
      <select id="unitSelect"></select>
      <button onclick="startQuiz()">ëœë¤ ë¬¸ì œ í’€ê¸°</button>
    </div>

    <div class="card" id="quizBox">
      <h3>ë¬¸ì œë¥¼ ë¶ˆëŸ¬ì™€ ì£¼ì„¸ìš” ğŸ“œ</h3>
    </div>
  </main>
</section>

<script>
/* ---------- í™”ë©´ ì „í™˜ ---------- */
function startApp(){
  document.getElementById("startScreen").classList.add("hidden");
  document.getElementById("mainScreen").classList.remove("hidden");
}

/* ---------- ë¬¸ì œ ì‹œìŠ¤í…œ ---------- */
let allQuestions=[];
let currentQuestion=null;

csvFile.addEventListener("change", e=>{
  const reader=new FileReader();
  reader.onload=()=>parseCSV(reader.result);
  reader.readAsText(e.target.files[0],'utf-8');
});

function parseCSV(text){
  const rows=text.trim().split("\n").slice(1);
  allQuestions=rows.map(r=>{
    const [subject,unit,question,choices,answer]=r.split(",");
    return{
      subject,unit,question,
      choices:choices.split("|"),
      answer
    };
  });
  makeSubjectList();
}

function makeSubjectList(){
  const subjects=[...new Set(allQuestions.map(q=>q.subject))];
  subjectSelect.innerHTML="";
  subjects.forEach(s=>{
    subjectSelect.innerHTML+=`<option>${s}</option>`;
  });
  makeUnitList();
  subjectSelect.onchange=makeUnitList;
}

function makeUnitList(){
  const units=[...new Set(
    allQuestions.filter(q=>q.subject===subjectSelect.value)
    .map(q=>q.unit)
  )];
  unitSelect.innerHTML="";
  units.forEach(u=>{
    unitSelect.innerHTML+=`<option>${u}</option>`;
  });
}

function startQuiz(){
  const pool=allQuestions.filter(q=>
    q.subject===subjectSelect.value &&
    q.unit===unitSelect.value
  );
  currentQuestion=pool[Math.floor(Math.random()*pool.length)];
  showQuestion();
}

function showQuestion(){
  quizBox.innerHTML=`
    <h3>${currentQuestion.question}</h3>
    ${currentQuestion.choices.map(c=>
      `<button class="choice" onclick="checkAnswer('${c}')">${c}</button>`
    ).join("")}
  `;
}

function checkAnswer(choice){
  alert(choice===currentQuestion.answer ? "â­• ì •ë‹µ!" : "âŒ ì˜¤ë‹µ!");
}
</script>

</body>
</html>
